let frontendformsmain=function(){function submitCounter(){let el=document.getElementById("timecounter");if(el){let timeleft=parseInt(document.getElementById("minTime").getAttribute("data-time"));let timetext=document.getElementById("minTime").getAttribute("data-unit");timetext=timetext.split(";");let downloadTimer=setInterval(function(){if(timeleft<=0){clearInterval(downloadTimer);el.remove()}let text=timetext[0];if(timeleft<=1){text=timetext[1]}el.innerText=timeleft+" "+text;timeleft-=1},1000)}}window.addEventListener("load",function(){submitCounter();ajaxSubmit();jumpToAnchor();maxCharsCounterReverse();let frontendforms=document.getElementsByTagName('form');if(frontendforms.length>0){for(let i=0;i<frontendforms.length;i+=1){let formID=frontendforms[i].id;if(formID){if(typeof mfConditionalFields!=='undefined'){mfConditionalFields("#"+formID,{rules:"inline",dynamic:true,debug:true})}}}}});document.addEventListener('click',function(element){if(element.target.classList.contains('pwtoggle')){let passwordInput=element.target.parentNode.previousElementSibling;if(passwordInput.type==="password"){passwordInput.type="text"}else{passwordInput.type="password"}}});function removeURLParameter(url,parameter){let urlparts=url.split("?");if(urlparts.length>=2){let prefix=encodeURIComponent(parameter)+"=";let pars=urlparts[1].split(/[&;]/g);for(let i=pars.length;i-- >0;){if(pars[i].lastIndexOf(prefix,0)!==-1){pars.splice(i,1)}}url=urlparts[0]+"?"+pars.join("&");return url}else{return url}}function reloadCaptcha(id,event){event.preventDefault();let captcha=document.getElementById(id);if(captcha){let src=captcha.src;src=removeURLParameter(src,"time");captcha.src=src+"&time="+Date.now()}}function clearInputfield(event){let id=event.id;let uploadfield_id=id.replace("-clear","");let uploadfield=document.getElementById(uploadfield_id);if(uploadfield.value){uploadfield.value=null}let clear_link_id=id.replace("-clear","-clearlink-wrapper");let clear_link=document.getElementById(clear_link_id);if(clear_link){clear_link.style.display="none"}}function showClearLink(event){let id=event.target.id+"-clearlink-wrapper";let clear_link=document.getElementById(id);if(clear_link){if(event.target.files.length>0){clear_link.style.display="block"}else{clear_link.style.display="none"}}}let numInputs=document.querySelectorAll('input');for(let i=0;i<numInputs.length;i+=1){numInputs[i].addEventListener("change",changeHTML5AttributeValue,false);numInputs[i].addEventListener("change",calculateTimeRange,false)}function changeHTML5AttributeValue(){let field_data_ID=this.id.replace(this.form.id+"-","");let fields=document.querySelectorAll("[data-ff_field="+field_data_ID+"]");if(fields.length>0){for(let i=0;i<fields.length;i+=1){let field=document.getElementById(fields[i].id);if(field){let attribute=field.dataset.ff_attribute;let validator=field.dataset.ff_validator;let value=this.value;if(attribute&&value){if(validator){if(validator==="dateBeforeField"){value=calculateBeforeAfterValue(-1,value);value=value.toISOString().split('T')[0]}if(validator==="dateAfterField"){value=calculateBeforeAfterValue(1,value);value=value.toISOString().split('T')[0]}}field.setAttribute(attribute,value)}}}}}function calculateBeforeAfterValue(days,value){let result=new Date(value);result.setDate(result.getDate()+days);return result}function calculateTimeRange(){this.id.replace(this.form.id+"-","");let fields=document.querySelectorAll("[data-ff_validator]");if(fields.length>0){for(let i=0;i<fields.length;i+=1){let field=document.getElementById(fields[i].id);if(field&&((field.dataset.ff_validator==="dateWithinDaysRange")||(field.dataset.ff_validator==="dateOutsideOfDaysRange"))){let attribute=field.dataset.ff_attribute;let value=this.value;let days=field.dataset.ff_days;if(attribute==='min'){if(attribute&&value){let value2=calculateNewDate(value,days,'+');value2=new Date(value2).toISOString().slice(0,10);if(field.dataset.ff_validator==='dateOutsideOfDaysRange'){if(days>0){field.setAttribute('min',value2)}else if(days<0){field.setAttribute('max',value2)}else{field.removeAttribute('max')}}else{if(days>0){field.setAttribute('min',value);field.setAttribute('max',value2)}else{field.setAttribute('max',value);field.setAttribute('min',value2)}}}}else{field.removeAttribute("max")}}}}}function calculateNewDate(date,days,operator){let result=new Date(date);if(operator==='+'){result.setDate(result.getDate()+parseInt(days))}else{result.setDate(result.getDate()-parseInt(days))}return result}function jumpTo(anchor_id){let url=location.href;location.href="#"+anchor_id;history.replaceState(null,null,url);}function ajaxSubmit(formid=null){if(formid){let form=document.getElementById(formid);subAjax(form)}else{let pageforms=document.querySelectorAll('[data-submitajax]');if(pageforms.length){let i=0;for(i;i<pageforms.length;i+=1){subAjax(pageforms[i])}}}}function subAjax(form){if(typeof(form)=='string'){form=document.getElementById(form)}if(form){form.addEventListener('submit',function(e){e.preventDefault();let formid=form.dataset.submitajax;let action=form.getAttribute('action');let progress=document.getElementById(formid+'-form-submission');if(progress){progress.style.display=null}let anchor=action.split(/#(.*)/)[1];if(anchor!=='undefined'){anchor=formid+'-ajax-wrapper'}let xhr=new XMLHttpRequest();xhr.onload=function(){let result=this.responseText;const parser=new DOMParser();let doc=parser.parseFromString(result,"text/html");let wrapper=doc.getElementById(formid+'-ajax-wrapper');let content=wrapper.innerHTML;if(xhr.readyState===4&&xhr.status===200){let redirectFieldName=formid+'-ajax_redirect';let redirectUrl=formData.get(redirectFieldName);if(wrapper.dataset.validated==='1'){let anchorQueryString='';if(redirectUrl){let urlParts=redirectUrl.split('#');if(urlParts.length>1){redirectUrl=urlParts[0];let anchor=urlParts[1];anchorQueryString='?fc-anchor='+anchor}window.location=redirectUrl+anchorQueryString}else{document.getElementById(formid+'-ajax-wrapper').innerHTML=content;jumpTo(anchor)}}else{document.getElementById(formid+'-ajax-wrapper').innerHTML=content;jumpTo(anchor);reloadCaptcha(formid+'-captcha-image',e);ajaxSubmit();submitCounter();if(typeof listenToSliderCaptchaCheckboxes==="function"){console.log('test');listenToSliderCaptchaCheckboxes()}if(typeof stars!=='undefined'||stars!==null){stars.rebuild()}}}};xhr.open("POST",action);xhr.setRequestHeader('X-Requested-With','XMLHttpRequest');let formData=new FormData(form);xhr.send(formData)})}}function jumpToAnchor(){const urlParams=new URLSearchParams(window.location.search);const anchor=urlParams.get('fc-anchor');if(anchor){urlParams.delete("fc-anchor");location.hash="#"+anchor}}function maxCharsCounterReverse(){const textarea=document.querySelector("textarea");if(!textarea){return}textarea.addEventListener("input",event=>{const target=event.currentTarget;const maxLength=target.getAttribute("maxlength");if(maxLength){const currentLength=target.value.length;const counterSpan=document.getElementById(target.id+'-char_count');if(counterSpan){if(currentLength===maxLength){counterSpan.innerHTML=counterSpan.dataset.maxreached}else{counterSpan.children[0].innerHTML=maxLength-currentLength}}}})}}();
